import { useRef, useEffect, useState } from "react";
import { gsap } from "gsap";
import { ScrollTrigger } from "gsap/ScrollTrigger";
import Image from "next/image";
import { FaAngleDoubleDown } from "react-icons/fa";
import VerticalMarquee from "./marque";
//import EventideSVG from "public/eventide_1.svg";

gsap.registerPlugin(ScrollTrigger);

function Parallax() {
  const container = useRef(null);
  const black = useRef(null);
  const stage = useRef(null);
  const man = useRef(null);
  const firstlight = useRef(null);
  const full = useRef(null);
  const eventide = useRef(null);
  const [background, setBackground] = useState(20);

  useEffect(() => {
    let ctx = gsap.context(() => {
      var tl = gsap.timeline({
        scrollTrigger: {
          trigger: container.current,
          start: "top top",
          end: `+=${container.current.offsetHeight}`,
          scrub: true,
          pin: true,
          onUpdate: (self) => {
            setBackground(Math.ceil(self.progress * 100 + 20));
          },
        },
      });

      // Animating eventide to appear with opacity and scaling
      tl.fromTo(
        eventide.current,
        { opacity: 1, scale: 3 }, // Starting state
        { opacity: 1, scale: 2, duration: 5, ease: "power2.inOut" } ,0// Target state
      );

      // Fade out black background and stage elements
      tl
        .to(black.current, { opacity: 0, duration: 4, ease: "power2.inOut" }, 0.5)
        .to(stage.current, { opacity: 0, y: "-=10", duration: 4, ease: "power2.inOut" }, 3)
        .to(man.current, { opacity: 0, y: "-=10", duration: 4, ease: "power2.inOut" }, 5)
        .to(full.current, { opacity: 1, duration: 4, ease: "power2.inOut" }, 9);

    }, container);

    return () => ctx.revert();
  }, []);
    return (
        <div className="overflow-hidden">
            <div ref={container} className="relative h-screen w-screen flex flex-col justify-center items-center">
                <div ref={eventide}  className="absolute bottom-[8vh] md:scale-[2] sm:scale-[2] z-50 flex justify-center items-center w-full h-full">
                     <div>
                   
                        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="344" height="80">
                        {/* <path d="M0 0 C113.52 0 227.04 0 344 0 C344 26.4 344 52.8 344 80 C230.48 80 116.96 80 0 80 C0 53.6 0 27.2 0 0 Z " fill="#080808" transform="translate(0,0)"/> */}
                        <path d="M0 0 C1.52864532 0.86127957 3.05016549 1.73539146 4.5625 2.625 C5.89080058 3.30163859 7.22251914 3.97179749 8.5625 4.625 C9.8825 2.315 11.2025 0.005 12.5625 -2.375 C17.1825 -2.375 21.8025 -2.375 26.5625 -2.375 C26.5625 -1.715 26.5625 -1.055 26.5625 -0.375 C27.5215625 -0.87 27.5215625 -0.87 28.5 -1.375 C34.67929779 -3.39272989 39.80587172 -3.03374413 45.75 -0.375 C51.59074939 2.80920917 55.45739914 7.30969742 57.5625 13.625 C57.64731773 16.21130224 57.67848229 18.76978056 57.66015625 21.35546875 C57.6587413 22.10588943 57.65732635 22.85631012 57.65586853 23.62947083 C57.6502756 26.0238546 57.63772444 28.41814453 57.625 30.8125 C57.61998408 32.43684761 57.61542134 34.06119668 57.61132812 35.68554688 C57.60030848 39.66540069 57.58304873 43.64518444 57.5625 47.625 C53.6025 47.625 49.6425 47.625 45.5625 47.625 C45.55839111 46.68180908 45.55428223 45.73861816 45.55004883 44.7668457 C45.52301141 41.25306324 45.47387159 37.74101318 45.40991211 34.2277832 C45.38677549 32.70998832 45.37234652 31.19203387 45.36694336 29.67407227 C45.35762078 27.4861357 45.31656849 25.30069313 45.26953125 23.11328125 C45.2538208 21.79884033 45.23811035 20.48439941 45.22192383 19.13012695 C44.41016825 14.81528991 42.94441271 13.33282818 39.5625 10.625 C36.53601665 9.71761859 34.8128193 10.16066867 31.5625 10.625 C29.20898393 12.11254278 29.20898393 12.11254278 27.5625 14.625 C27.14448231 17.2923866 26.95780042 19.56608981 26.953125 22.234375 C26.93658875 22.96118469 26.92005249 23.68799438 26.90301514 24.43682861 C26.85457639 26.74963869 26.83317511 29.06179157 26.8125 31.375 C26.78433659 32.94664757 26.75440863 34.51826459 26.72265625 36.08984375 C26.64881953 39.93484169 26.59922052 43.77947572 26.5625 47.625 C22.6025 47.625 18.6425 47.625 14.5625 47.625 C14.5625 34.095 14.5625 20.565 14.5625 6.625 C12.9125 6.625 11.2625 6.625 9.5625 6.625 C10.078125 7.32625 10.59375 8.0275 11.125 8.75 C12.9227852 12.3455704 12.75112567 13.82139785 11.5625 17.625 C9.98828125 20.29296875 9.98828125 20.29296875 7.5625 22.625 C4.75010674 22.99898847 2.58657845 23.10793015 -0.1875 22.9375 C-0.88488281 22.91494141 -1.58226562 22.89238281 -2.30078125 22.86914062 C-4.01394935 22.81047048 -5.72600623 22.72079256 -7.4375 22.625 C-5.95661112 18.84551404 -4.28702557 15.2399818 -2.4375 11.625 C-7.24350296 10.2984562 -12.76909028 9.1413199 -17.3203125 11.671875 C-20.14686387 13.99319738 -22.26060785 15.89349803 -22.640625 19.61328125 C-22.7624854 25.65552624 -21.91824632 28.85801372 -17.8125 33.4375 C-14.08909601 35.299202 -10.51662568 35.16499159 -6.4375 34.625 C-3.36681526 33.28991968 -1.90220194 32.4058158 -0.19140625 29.53125 C1.5625 27.625 1.5625 27.625 4.48046875 27.234375 C5.55941406 27.28078125 6.63835937 27.3271875 7.75 27.375 C8.83667969 27.41109375 9.92335937 27.4471875 11.04296875 27.484375 C12.29013672 27.55398437 12.29013672 27.55398437 13.5625 27.625 C12.38877583 34.29129745 9.99691142 38.7752463 4.6875 42.9375 C-1.99126967 47.53298372 -8.41687401 48.66974911 -16.4375 47.625 C-24.96268885 44.88519756 -29.8730644 39.98454051 -34.3125 32.4375 C-36.44413825 25.21361481 -36.5703676 18.28191572 -33.5 11.3125 C-26.64108855 -0.82249717 -12.70380477 -6.370695 0 0 Z " fill="#FFFFFF" transform="translate(132.4375,13.375)"/>
                        <path d="M0 0 C3.96 0 7.92 0 12 0 C12.0997145 5.08620644 12.17186281 10.17182992 12.21972656 15.25878906 C12.23970285 16.98512702 12.26689372 18.71139853 12.30175781 20.4375 C12.51996033 31.52732193 12.26497128 40.14558187 6.25 49.8125 C-0.39639527 56.27427318 -6.90586765 58.44972923 -16.05078125 58.33984375 C-22.60078513 57.58507509 -28.01103368 54.4548635 -32.4375 49.625 C-37.80739164 42.52092239 -39.06002878 35.7597983 -38 27 C-37.04544904 24.02375906 -35.73568499 21.58840827 -34 19 C-33.1646875 17.6696875 -33.1646875 17.6696875 -32.3125 16.3125 C-27.08050249 11.08050249 -22.25226787 8.75283456 -14.84863281 8.56176758 C-9.6473872 8.56353031 -5.79681697 8.60159152 -1 11 C-0.67 7.37 -0.34 3.74 0 0 Z " fill="#FDFDFD" transform="translate(281,3)"/>
                        <path d="M0 0 C3.81115152 2.13811036 6.78224184 4.45287672 9.625 7.8125 C10.553125 8.7715625 10.553125 8.7715625 11.5 9.75 C12.625 11.8125 12.625 11.8125 12.5625 14.75 C11.45024415 18.38336912 10.37270376 20.17541234 7.625 22.8125 C4.81260674 23.18648847 2.64907845 23.29543015 -0.125 23.125 C-0.82238281 23.10244141 -1.51976562 23.07988281 -2.23828125 23.05664062 C-3.95144935 22.99797048 -5.66350623 22.90829256 -7.375 22.8125 C-5.89411112 19.03301404 -4.22452557 15.4274818 -2.375 11.8125 C-7.18100296 10.4859562 -12.70659028 9.3288199 -17.2578125 11.859375 C-20.08436387 14.18069738 -22.19810785 16.08099803 -22.578125 19.80078125 C-22.6999854 25.84302624 -21.85574632 29.04551372 -17.75 33.625 C-14.02659601 35.486702 -10.45412568 35.35249159 -6.375 34.8125 C-3.30431526 33.47741968 -1.83970194 32.5933158 -0.12890625 29.71875 C1.625 27.8125 1.625 27.8125 4.54296875 27.421875 C5.62191406 27.46828125 6.70085937 27.5146875 7.8125 27.5625 C8.89917969 27.59859375 9.98585938 27.6346875 11.10546875 27.671875 C12.35263672 27.74148437 12.35263672 27.74148437 13.625 27.8125 C12.45127583 34.47879745 10.05941142 38.9627463 4.75 43.125 C-1.92876967 47.72048372 -8.35437401 48.85724911 -16.375 47.8125 C-24.90018885 45.07269756 -29.8105644 40.17204051 -34.25 32.625 C-36.38163825 25.40111481 -36.5078676 18.46941572 -33.4375 11.5 C-26.59456088 -0.60673844 -12.76439575 -6.06738094 0 0 Z " fill="#FDFDFD" transform="translate(329.375,13.1875)"/>
                        <path d="M0 0 C3.81115152 2.13811036 6.78224184 4.45287672 9.625 7.8125 C10.553125 8.7715625 10.553125 8.7715625 11.5 9.75 C12.625 11.8125 12.625 11.8125 12.5625 14.75 C11.45024415 18.38336912 10.37270376 20.17541234 7.625 22.8125 C4.81260674 23.18648847 2.64907845 23.29543015 -0.125 23.125 C-0.82238281 23.10244141 -1.51976562 23.07988281 -2.23828125 23.05664062 C-3.95144935 22.99797048 -5.66350623 22.90829256 -7.375 22.8125 C-5.89411112 19.03301404 -4.22452557 15.4274818 -2.375 11.8125 C-7.18100296 10.4859562 -12.70659028 9.3288199 -17.2578125 11.859375 C-20.08436387 14.18069738 -22.19810785 16.08099803 -22.578125 19.80078125 C-22.6999854 25.84302624 -21.85574632 29.04551372 -17.75 33.625 C-14.02659601 35.486702 -10.45412568 35.35249159 -6.375 34.8125 C-3.30431526 33.47741968 -1.83970194 32.5933158 -0.12890625 29.71875 C1.625 27.8125 1.625 27.8125 4.54296875 27.421875 C5.62191406 27.46828125 6.70085938 27.5146875 7.8125 27.5625 C8.89917969 27.59859375 9.98585937 27.6346875 11.10546875 27.671875 C12.35263672 27.74148437 12.35263672 27.74148437 13.625 27.8125 C12.45127583 34.47879745 10.05941142 38.9627463 4.75 43.125 C-1.92876967 47.72048372 -8.35437401 48.85724911 -16.375 47.8125 C-23.14508006 45.63674974 -28.7322181 42.00402698 -32.375 35.8125 C-35.39771101 28.88210175 -36.8969397 21.59153769 -34.56640625 14.2734375 C-31.33075135 6.86166053 -26.20615398 2.09366492 -18.91796875 -1.34765625 C-12.43492818 -3.4887526 -6.12441809 -2.91115837 0 0 Z " fill="#FDFDFD" transform="translate(35.375,13.1875)"/>
                        <path d="M0 0 C4.29 0 8.58 0 13 0 C13.33 10.56 13.66 21.12 14 32 C16.0728125 29.0609375 16.0728125 29.0609375 18.1875 26.0625 C33.51463211 4.48536789 33.51463211 4.48536789 38 0 C40.18639453 -0.07258946 42.37500389 -0.08373783 44.5625 -0.0625 C46.35880859 -0.04896484 46.35880859 -0.04896484 48.19140625 -0.03515625 C49.11824219 -0.02355469 50.04507813 -0.01195312 51 0 C49.21441915 3.96795744 46.72483952 7.44252813 44.25 11 C43.77336914 11.68916504 43.29673828 12.37833008 42.80566406 13.08837891 C29.97463083 31.61159056 29.97463083 31.61159056 25.65429688 37.55761719 C23.92777871 40.00094623 23.92777871 40.00094623 22.54882812 42.82519531 C21.015625 45.6015625 21.015625 45.6015625 17 50 C12.05 50 7.1 50 2 50 C2 36.14 2 22.28 2 8 C0.02 8 -1.96 8 -4 8 C-2.87548273 5.0280615 -1.77706209 2.66559313 0 0 Z " fill="#FDFDFD" transform="translate(55,11)"/>
                        <path d="M0 0 C3.2578125 -0.29296875 3.2578125 -0.29296875 7.125 -0.1875 C9.04699219 -0.14689453 9.04699219 -0.14689453 11.0078125 -0.10546875 C11.99523437 -0.07066406 12.98265625 -0.03585937 14 0 C14 3.63 14 7.26 14 11 C20.93 11 27.86 11 35 11 C35 14.96 35 18.92 35 23 C28.07 23 21.14 23 14 23 C14.103125 25.866875 14.20625 28.73375 14.3125 31.6875 C14.34984253 33.02880981 14.34984253 33.02880981 14.38793945 34.3972168 C14.60092611 39.01814629 14.99602115 42.26821629 18 46 C21.63719605 48.42479736 23.85703482 48.38662577 28.1875 48.625 C29.45980469 48.69976562 30.73210937 48.77453125 32.04296875 48.8515625 C33.01878906 48.90054688 33.99460938 48.94953125 35 49 C35 52.96 35 56.92 35 61 C18.18713201 61.99681036 18.18713201 61.99681036 11 56 C5.99700878 51.25102379 2.27507613 46.14513567 1.65942383 39.10595703 C1.65989284 37.65648872 1.67648683 36.20695902 1.70703125 34.7578125 C1.71127609 33.98944061 1.71552094 33.22106873 1.71989441 32.42941284 C1.73658174 29.99424015 1.77421359 27.5599192 1.8125 25.125 C1.82755977 23.46615785 1.84124591 21.80730263 1.85351562 20.1484375 C1.88645241 16.0986341 1.93816406 12.04946106 2 8 C0.02 8 -1.96 8 -4 8 C-2.87548273 5.0280615 -1.77706209 2.66559313 0 0 Z " fill="#FDFDFD" transform="translate(190,0)"/>
                        <path d="M0 0 C1.65 0 3.3 0 5 0 C5.0867562 4.29154022 5.1403089 8.58285668 5.1875 12.875 C5.21263672 14.09832031 5.23777344 15.32164063 5.26367188 16.58203125 C5.27333984 17.74863281 5.28300781 18.91523437 5.29296875 20.1171875 C5.3086792 21.19597168 5.32438965 22.27475586 5.34057617 23.38623047 C5.22818604 24.24877441 5.1157959 25.11131836 5 26 C4.01 26.66 3.02 27.32 2 28 C2.66 25.69 3.32 23.38 4 21 C-3.30318195 20.74011685 -3.30318195 20.74011685 -9.8046875 23.3671875 C-10.94951007 24.85332363 -11.98224495 26.42412121 -13 28 C-17.09613173 29.36537724 -20.72690687 29.76406301 -25 29 C-28.92710616 26.70191565 -31.55264149 24.34207553 -33 20 C-33.61600642 15.97646441 -33.88041726 12.46284714 -31.73046875 8.890625 C-26.85937547 3.1543497 -26.85937547 3.1543497 -22.9765625 2.83203125 C-21.81253906 2.82236328 -21.81253906 2.82236328 -20.625 2.8125 C-19.85414062 2.79832031 -19.08328125 2.78414062 -18.2890625 2.76953125 C-15.78165112 3.02198393 -14.16738098 3.74806533 -12 5 C-12.53344232 9.53425972 -14.43101626 12.29038748 -17 16 C-14.57848587 15.99397633 -12.16972788 15.94656312 -9.75 15.875 C-9.06808594 15.87757812 -8.38617188 15.88015625 -7.68359375 15.8828125 C-5.37360545 15.85220409 -5.37360545 15.85220409 -2 15 C1.3384904 11.19746458 1.3384904 11.19746458 1.8125 6.375 C1.544375 5.59125 1.27625 4.8075 1 4 C0.814375 3.236875 0.62875 2.47375 0.4375 1.6875 C0.293125 1.130625 0.14875 0.57375 0 0 Z " fill="#FDFDFD" transform="translate(142,20)"/>
                        <path d="M0 0 C0.77085937 -0.01417969 1.54171875 -0.02835938 2.3359375 -0.04296875 C4.84334888 0.20948393 6.45761902 0.93556533 8.625 2.1875 C8.09155768 6.72175972 6.19398374 9.47788748 3.625 13.1875 C6.04651413 13.18147633 8.45527212 13.13406312 10.875 13.0625 C11.55691406 13.06507812 12.23882812 13.06765625 12.94140625 13.0703125 C15.25139455 13.03970409 15.25139455 13.03970409 18.625 12.1875 C20.96288996 9.2854086 20.96288996 9.2854086 22.625 6.1875 C23.615 5.8575 24.605 5.5275 25.625 5.1875 C25.70569658 8.14637459 25.76534665 11.1030659 25.8125 14.0625 C25.83763672 14.90425781 25.86277344 15.74601562 25.88867188 16.61328125 C25.89833984 17.41894531 25.90800781 18.22460938 25.91796875 19.0546875 C25.9336792 19.79831543 25.94938965 20.54194336 25.96557617 21.30810547 C25.79699097 22.23840576 25.79699097 22.23840576 25.625 23.1875 C24.635 23.8475 23.645 24.5075 22.625 25.1875 C23.285 22.8775 23.945 20.5675 24.625 18.1875 C17.32181805 17.92761685 17.32181805 17.92761685 10.8203125 20.5546875 C9.67548993 22.04082363 8.64275505 23.61162121 7.625 25.1875 C3.52886827 26.55287724 -0.10190687 26.95156301 -4.375 26.1875 C-8.30210616 23.88941565 -10.92764149 21.52957553 -12.375 17.1875 C-12.99100642 13.16396441 -13.25541726 9.65034714 -11.10546875 6.078125 C-7.63385324 1.98989652 -5.473601 0.0454618 0 0 Z " fill="#FDFDFD" transform="translate(318.375,22.8125)"/>
                        <path d="M0 0 C3.96 0 7.92 0 12 0 C12 15.18 12 30.36 12 46 C8.04 46 4.08 46 0 46 C0 30.82 0 15.64 0 0 Z " fill="#FDFDFD" transform="translate(228,15)"/>
                        <path d="M0 0 C5.15055847 1.78288562 7.56506082 4.13012164 10 9 C10.6506249 14.20499921 9.910372 17.634442 7 22 C3.58642134 25.08847593 0.96294163 26.26431338 -3.5625 26.4375 C-7.45724694 26.23458041 -10.00053395 25.64658769 -13 23 C-15.86031035 18.85748157 -16.58389811 15.1185042 -16.42578125 10.18359375 C-15.68518665 6.38549851 -13.77454471 4.64549612 -11 2 C-7.26935711 -0.48709526 -4.31847665 -0.51625053 0 0 Z " fill="#FDFDFD" transform="translate(271,23)"/>
                        <path d="M0 0 C3.96 0 7.92 0 12 0 C12.09765625 8.49609375 12.09765625 8.49609375 12 11 C11 12 11 12 8.49609375 12.09765625 C5.6640625 12.06510417 2.83203125 12.03255208 0 12 C0 8.04 0 4.08 0 0 Z " fill="#FDFDFD" transform="translate(228,0)"/>
                        <path d="M0 0 C0.99 0.33 1.98 0.66 3 1 C2.01 2.98 1.02 4.96 0 7 C-0.99 6.67 -1.98 6.34 -3 6 C-1.125 1.125 -1.125 1.125 0 0 Z " fill="#FDFDFD" transform="translate(99,21)"/>
                        </svg>

                    </div>
                </div>
                <div ref={black} className="absolute z-40 w-full h-full opacity-1">
                    
                        <VerticalMarquee className="z-40" />
                    
                       
                    
                    <div className="inset-0 flex justify-center items-center">
                        <div className="z-30 bg-white tex animate-bounce absolute md:top-[92%] sm:top-[90%] w-60 rounded-full px-3 py-2 flex items-center justify-center">
                            Scroll <FaAngleDoubleDown className="ml-2" />
                        </div>
                    </div>
                </div>
                <div ref={stage} className="absolute z-30 w-full h-full opacity-1">
                    <Image alt="stage" src="/images/stage.jpg" layout="fill" objectFit="cover" />
                </div>
                <div ref={man} className="absolute z-20 w-full h-full opacity-1">
                    <Image alt="man" src="/images/manwstage.jpg" layout="fill" objectFit="cover" />
                </div>
                <div ref={full} className="absolute z-0 w-full h-full opacity-1">
                    <Image alt="full" src="/images/full.jpg" layout="fill" objectFit="cover" />
                </div>

              
            </div>
        </div>
    );
}

export default Parallax;
